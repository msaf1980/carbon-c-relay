container:
  image: ubuntu:bionic

task:
  matrix:
    - name: Build on Ubuntu (lz4)
      install_dependencies_script:
        - apt-get update
        - apt-get install -y libonig-dev libpcre3-dev zlib1g-dev libssl-dev libevent-dev gcc make automake bison flex
      script: ./build-test.sh
      container:
        matrix:
          - image: ubuntu:20.04
    - name: Build on Ubuntu (without lz4)
      install_dependencies_script:
        - apt-get update
        - apt-get install -y libonig-dev libpcre3-dev zlib1g-dev libssl-dev libevent-dev gcc make automake bison flex
      script: ./build-test.sh
      container:
        matrix:
          - image: ubuntu:16.04
          - image: ubuntu:18.04          
    - name: Build on CentOS (without lz4)
      install_dependencies_script:
        - yum install -y epel-release
        - yum install -y gcc make automake bison flex libtool oniguruma-devel zlib-devel openssl-devel libevent-devel
      script: ./build-test.sh
      container:
        matrix:
          - image: centos:7
